<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time slices · SpineOpt.jl</title><meta name="title" content="Time slices · SpineOpt.jl"/><meta property="og:title" content="Time slices · SpineOpt.jl"/><meta property="twitter:title" content="Time slices · SpineOpt.jl"/><meta name="description" content="Documentation for SpineOpt.jl."/><meta property="og:description" content="Documentation for SpineOpt.jl."/><meta property="twitter:description" content="Documentation for SpineOpt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SpineOpt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpineOpt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/setup_workflow/">Setting up a workflow</a></li><li><a class="tocitem" href="../../getting_started/creating_your_own_model/">Creating Your Own Model</a></li><li><a class="tocitem" href="../../getting_started/archetypes/">Archetypes</a></li><li><a class="tocitem" href="../../getting_started/output_data/">Managing Outputs</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorial/webinars/">Webinars</a></li><li><a class="tocitem" href="../../tutorial/simple_system/">Simple system</a></li><li><a class="tocitem" href="../../tutorial/reserves/">Reserve requirements</a></li><li><a class="tocitem" href="../../tutorial/ramping/">Ramping constraints</a></li><li><a class="tocitem" href="../../tutorial/unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../../tutorial/tutorialTwoHydro/">Two hydro plants</a></li><li><a class="tocitem" href="../../tutorial/case_study_a5/">Case Study A5</a></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../../how_to/change_the_solver/">Change the solver</a></li><li><a class="tocitem" href="../../how_to/define_an_efficiency/">Define an efficiency</a></li><li><a class="tocitem" href="../../how_to/print_the_model/">Print the model</a></li></ul></li><li><span class="tocitem">Concept Reference</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the model structure</a></li><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints_automatically_generated/">Constraints</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li></ul></li><li><span class="tocitem">Advanced Concepts</span><ul><li><a class="tocitem" href="../../advanced_concepts/temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/stochastic_framework/">Stochastic Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../../advanced_concepts/ramping/">Ramping</a></li><li><a class="tocitem" href="../../advanced_concepts/reserves/">Reserves</a></li><li><a class="tocitem" href="../../advanced_concepts/investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../../advanced_concepts/user_constraints/">User Constraints</a></li><li><a class="tocitem" href="../../advanced_concepts/decomposition/">Decomposition</a></li><li><a class="tocitem" href="../../advanced_concepts/powerflow/">PTDF-Based Powerflow</a></li><li><a class="tocitem" href="../../advanced_concepts/pressure_driven_gas_transfer/">Pressure driven gas transfer</a></li><li><a class="tocitem" href="../../advanced_concepts/Lossless_DC_power_flow/">Lossless nodal DC power flows</a></li><li><a class="tocitem" href="../../advanced_concepts/representative_days_w_seasonal_storage/">Representative days with seasonal storages</a></li><li><a class="tocitem" href="../../advanced_concepts/cumulated_flow_restrictions/">Imposing renewable energy targets</a></li><li><a class="tocitem" href="../../advanced_concepts/mga/">Modelling to generate alternatives</a></li></ul></li><li><span class="tocitem">Implementation details</span><ul><li><a class="tocitem" href="../documentation/">Documentation</a></li><li><a class="tocitem" href="../how_does_the_model_update_itself/">How does the model update itself</a></li><li><a class="tocitem" href="../how_to_write_a_constraint/">How to write a constraint</a></li><li class="is-active"><a class="tocitem" href>Time slices</a><ul class="internal"><li><a class="tocitem" href="#From-temporal-block-to-time-slices"><span>From temporal block to time slices</span></a></li><li><a class="tocitem" href="#What-are-the-time-slice-convenience-functions?"><span>What are the time slice convenience functions?</span></a></li><li><a class="tocitem" href="#How-can-the-time-slice-convenience-functions-be-used?"><span>How can the time slice convenience functions be used?</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Implementation details</a></li><li class="is-active"><a href>Time slices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time slices</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl/blob/master/docs/src/implementation_details/time_slices.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-does-SpineOpt-perceive-time?"><a class="docs-heading-anchor" href="#How-does-SpineOpt-perceive-time?">How does SpineOpt perceive time?</a><a id="How-does-SpineOpt-perceive-time?-1"></a><a class="docs-heading-anchor-permalink" href="#How-does-SpineOpt-perceive-time?" title="Permalink"></a></h1><p>Questions:</p><ol><li>What are time slices?</li><li>What are time slices functions?</li><li>How can they be used?</li></ol><h2 id="From-temporal-block-to-time-slices"><a class="docs-heading-anchor" href="#From-temporal-block-to-time-slices">From temporal block to time slices</a><a id="From-temporal-block-to-time-slices-1"></a><a class="docs-heading-anchor-permalink" href="#From-temporal-block-to-time-slices" title="Permalink"></a></h2><p>Overview of the process:</p><ol><li>run<em>spineopt  a. create time slices for each of the (model) temporal blocks  b. create fictitious relationships between time slice objects      i. relationship between two consecutive time slices (t\</em>before and t_after)      ii. relationship between overlapping time slices (t_short which is in t_long)  c. store these in m.ext</li><li>time slice convenience functions  a. fetch generated relations from m.ext</li></ol><p>SpineOpt starts with the <em>run_spineopt</em> function. One of its main parts is to create the temporal (and stochastic) structure. The temporal structure starts from the temporal blocks in the input data. Only the temporal blocks that are connected to a model object are considered. Time slices are created for each of these temporal blocks. A time slice is characterised by a start time and an end time. In other words, the time frame is composed of a bunch of segments, determined from the resolution of the temporal block between the model start and end time.</p><p>To keep track of the order of the time slices, SpineOpt then creates a fictitious relationship between time slice objects (across all temporal blocks connected to the model). There are two types of relationships, i.e. a relationship between consecutive time steps and a relationship between overlapping time steps.</p><p>These time slices and their relationships are stored in m.ext. To later make use of the time slices and their relationships, there are time slice convenience functions that fetch the generated slices and relations from m.ext.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>m is the model that SpineOpt builds and sends to the JuMP solver. m.ext is an additional field where SpineOpt stores some extra stuff.</p></div></div><h2 id="What-are-the-time-slice-convenience-functions?"><a class="docs-heading-anchor" href="#What-are-the-time-slice-convenience-functions?">What are the time slice convenience functions?</a><a id="What-are-the-time-slice-convenience-functions?-1"></a><a class="docs-heading-anchor-permalink" href="#What-are-the-time-slice-convenience-functions?" title="Permalink"></a></h2><p>The time slice convenience functions help with the interaction of time slices in constraints.</p><p>The functionality is similar to a dictionary or a lookup table; for each time slice function and for each time slice collect all time slices of all temporal blocks combined.</p><p>The functions are (with t* the input time slice):</p><p>t_in_t</p><ul><li>uses the relationship between t_short and t_long</li><li>if you provide the keyword <code>short=t*</code></li></ul><p>you get t_long in which t* resides</p><ul><li>if you provide the keyword <code>long=t*</code></li></ul><p>you get t_short that is contained in t*</p><p>t_consecutive_t</p><ul><li>uses the relationship between t_before and t_after</li><li>if you provide the keyword <code>t\_before=t*</code></li></ul><p>you get all the possible t_after</p><ul><li>if you provide the keyword <code>t\_after=t*</code></li></ul><p>you get all the possible t_before</p><p>t_overlapping_t</p><ul><li>is a dictionary from a time slice to an array of time slices</li><li>it uses a dictionary instead of a relationship because the operation is symmetric and does not require logic and loops</li><li>provides all overlapping time slices (including partially overlapping time slices)</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If you are looking for the time slice convenience functions in the code, you should not look for a typical <em>function end</em> structure but rather the short hand notation in <em>f()</em> format.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To further figure out what the time slice convenience functions do, you can play around with these functions. To do so, you first need to make a database (e.g. in SpineToolbox). Then you can run run<em>spineopt with that database and collect the model m. If you are impatient you do not even need to solve the model and set the optimize option to <em>false</em>. And then you can start with calling the time slice convenience functions with m (e.g. t</em>in_t).</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Older versions of SpineOpt use t_before_t instead of t_consecutive_t but that naming has changed because it is rather confusing.</p><p>There was also a variation on the time slicing functions with _excl which excludes t* from the returned time slices. That functionality was scrapped because it was not used.</p></div></div><h2 id="How-can-the-time-slice-convenience-functions-be-used?"><a class="docs-heading-anchor" href="#How-can-the-time-slice-convenience-functions-be-used?">How can the time slice convenience functions be used?</a><a id="How-can-the-time-slice-convenience-functions-be-used?-1"></a><a class="docs-heading-anchor-permalink" href="#How-can-the-time-slice-convenience-functions-be-used?" title="Permalink"></a></h2><p>When designing a constraint in SpineOpt, you should determine which time slices to use as a reference (which will be obtained from the index function below the constraint). The reference time slice can be used directly in the constraints whereas the other time slices (for each variable and parameter) need to be determined from the reference using the time slicing functions.</p><p>A fool proof way of designing the constraint is to always consider the highest resolution among the overlapping time slices as the reference time slice. The other time slices can then be obtained from t_overlapping_t.</p><p>More information can be found in the design of constraints.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_to_write_a_constraint/">« How to write a constraint</a><a class="docs-footer-nextpage" href="../../library/">Library »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 12 March 2024 09:53">Tuesday 12 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
