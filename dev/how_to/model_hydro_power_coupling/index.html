<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model hydro power coupling · SpineOpt.jl</title><meta name="title" content="Model hydro power coupling · SpineOpt.jl"/><meta property="og:title" content="Model hydro power coupling · SpineOpt.jl"/><meta property="twitter:title" content="Model hydro power coupling · SpineOpt.jl"/><meta name="description" content="Documentation for SpineOpt.jl."/><meta property="og:description" content="Documentation for SpineOpt.jl."/><meta property="twitter:description" content="Documentation for SpineOpt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SpineOpt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpineOpt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/recommended_workflow/">Verify installation</a></li><li><a class="tocitem" href="../../getting_started/troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../../getting_started/performance_tips/">Performace tips</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorial/webinars/">Webinars</a></li><li><a class="tocitem" href="../../tutorial/simple_system/">Simple system</a></li><li><a class="tocitem" href="../../tutorial/temporal_resolution/">Temporal resolution</a></li><li><a class="tocitem" href="../../tutorial/stochastic_system/">Stochastic structure</a></li><li><a class="tocitem" href="../../tutorial/capacity_planning/">Capacity planning</a></li><li><a class="tocitem" href="../../tutorial/multi-year_investment/">Multi-year investments using economic parameters</a></li><li><a class="tocitem" href="../../tutorial/reserves/">Reserve requirements</a></li><li><a class="tocitem" href="../../tutorial/ramping/">Ramping constraints</a></li><li><a class="tocitem" href="../../tutorial/unit_commitment/">Unit Commitment</a></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../change_the_solver/">Change the solver</a></li><li><a class="tocitem" href="../compile_julia_system_image/">Compile julia system image</a></li><li><a class="tocitem" href="../define_an_efficiency/">Define an efficiency</a></li><li><a class="tocitem" href="../impose_renewable_energy_targets/">Impose renewable energy targets</a></li><li><a class="tocitem" href="../manage_output/">Manage output</a></li><li class="is-active"><a class="tocitem" href>Model hydro power coupling</a><ul class="internal"><li><a class="tocitem" href="#Context"><span>Context</span></a></li><li><a class="tocitem" href="#Setting-up-a-Basic-Hydro-power-Model"><span>Setting up a Basic Hydro power Model</span></a></li><li><a class="tocitem" href="#Maximisation-of-Stored-Water"><span>Maximisation of Stored Water</span></a></li><li><a class="tocitem" href="#Spillage-Constraints-Minimisation-of-Spilt-Water"><span>Spillage Constraints - Minimisation of Spilt Water</span></a></li><li><a class="tocitem" href="#Follow-Contracted-Load-Curve"><span>Follow Contracted Load Curve</span></a></li></ul></li><li><a class="tocitem" href="../print_the_model/">Print the model</a></li><li><a class="tocitem" href="../set_up_representative_days_for_investment_problems/">Set up representative days for investment problems</a></li></ul></li><li><a class="tocitem" href="../../gallery/gallery/">Example gallery</a></li><li><span class="tocitem">Database structure</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the data structure</a></li><li><a class="tocitem" href="../../concept_reference/archetypes/">Archetypes</a></li></ul></li><li><span class="tocitem">Standard model framework</span><ul><li><a class="tocitem" href="../../advanced_concepts/temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/stochastic_framework/">Stochastic Framework</a></li></ul></li><li><span class="tocitem">Standard model features</span><ul><li><a class="tocitem" href="../../advanced_concepts/unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../../advanced_concepts/investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../../advanced_concepts/multi-year/">Multi-year Investments</a></li><li><a class="tocitem" href="../../advanced_concepts/reserves/">Reserves</a></li><li><a class="tocitem" href="../../advanced_concepts/ramping/">Ramping</a></li><li><a class="tocitem" href="../../advanced_concepts/Lossless_DC_power_flow/">Lossless nodal DC power flows</a></li><li><a class="tocitem" href="../../advanced_concepts/powerflow/">PTDF-Based Powerflow</a></li><li><a class="tocitem" href="../../advanced_concepts/pressure_driven_gas_transfer/">Pressure driven gas transfer</a></li><li><a class="tocitem" href="../../advanced_concepts/user_constraints/">User Constraints</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../../advanced_concepts/decomposition/">Decomposition</a></li><li><a class="tocitem" href="../../advanced_concepts/mga/">Modelling to generate alternatives</a></li><li><a class="tocitem" href="../../advanced_concepts/multi_stage/">Multi-stage optimisation</a></li></ul></li><li><span class="tocitem">SpineOpt Template</span><ul><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints_automatically_generated/">Constraints</a></li></ul></li><li><span class="tocitem">Implementation details</span><ul><li><a class="tocitem" href="../../implementation_details/documentation/">Documentation</a></li><li><a class="tocitem" href="../../implementation_details/how_does_the_model_update_itself/">How does the model update itself</a></li><li><a class="tocitem" href="../../implementation_details/how_to_write_a_constraint/">How to write a constraint</a></li><li><a class="tocitem" href="../../implementation_details/time_slices/">Time slices</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to</a></li><li class="is-active"><a href>Model hydro power coupling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model hydro power coupling</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl/blob/master/docs/src/how_to/model_hydro_power_coupling.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-model-hydro-power-coupling"><a class="docs-heading-anchor" href="#How-to-model-hydro-power-coupling">How to model hydro power coupling</a><a id="How-to-model-hydro-power-coupling-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-model-hydro-power-coupling" title="Permalink"></a></h1><p>This how-to aims at demonstrating how we can model a hydropower system in Spine (<em>SpineOpt.jl</em> and <em>Spine-Toolbox</em>) with different assumptions and goals. It starts off by setting up a simple model of system of two hydropower plants and gradually introduces additional features.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In each of the next sections, we perform incremental changes to the initial simple hydropower model. If you want to keep the database that you created, you can duplicate the database file (right-click on the input database and select <strong>Duplicate and duplicate files</strong>) and perform the changes in the new database. You need to configure the workflow accordingly in order to run the database you want (please check the Simple System tutorial for how to do that).</p></div></div><h2 id="Context"><a class="docs-heading-anchor" href="#Context">Context</a><a id="Context-1"></a><a class="docs-heading-anchor-permalink" href="#Context" title="Permalink"></a></h2><p>The goal of the model is to capture the combined operation of two hydropower plants (Språnget and Fallet) that operate on the same river as shown in the picture bellow. Each power plant has its own reservoir and generates electricity by discharging water. The plants might need to spill water, i.e., release water from their reservoirs without generating electricity, for various reasons. The water discharged or spilled by the upstream power plant follows the river route and becomes available to the downstream power plant.</p><p><img src="../figs_two_hydro/two_hydro.png" alt="A system of two hydropower plants."/></p><h2 id="Setting-up-a-Basic-Hydro-power-Model"><a class="docs-heading-anchor" href="#Setting-up-a-Basic-Hydro-power-Model">Setting up a Basic Hydro power Model</a><a id="Setting-up-a-Basic-Hydro-power-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-a-Basic-Hydro-power-Model" title="Permalink"></a></h2><p>The picture below shows how such a system of hydro power plants translates to a SpineOpt model. It looks quite daunting at first glance, but we&#39;ll break it down in smaller parts in the following subsections.</p><p><img src="../figs_two_hydro/two_hydro_spineopt.png" alt="Two hydro power plants in SpineOpt"/></p><p><img src="../figs_two_hydro/two_hydro_parameters.png" alt="Parameters for the two hydro power plants in SpineOpt"/></p><h3 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h3><p>Before we can create the hydro power system, we&#39;ll have to define a model, temporal structure and stochastic structure. The basic model in the templates will do. Though, we&#39;ll change the temporal resolution to 6h and the model start / end to for 1 day as an example.</p><p>As for the report, we are typically interested in the outputs <em>node_state</em>, <em>unit_flows</em> and <em>connection_flows</em>.</p><h3 id="Nodes-and-commodities"><a class="docs-heading-anchor" href="#Nodes-and-commodities">Nodes and commodities</a><a id="Nodes-and-commodities-1"></a><a class="docs-heading-anchor-permalink" href="#Nodes-and-commodities" title="Permalink"></a></h3><p>Nodes are at the center of a SpineOpt system, so let&#39;s start with that. There are other ways to model hydro power plants but here we represent each hydro power plant with 2 nodes, an &#39;upper&#39; node to represent the water arriving at each plant and a &#39;lower&#39; node to represent the water that is discharged and becomes available to the next plant. The general idea of splitting these in 2 nodes is to be able to simulate a time delay between the entrance and the exit (although in this tutorial we will not go in detail in this time delay).</p><p>Additionally we need a node for electricity.</p><p>Optionally, we can indicate that we are dealing with water flows and electricity production through <em>commodities</em>. Note that commodities are only indicative and are not strictly necessary. As in the picture below, we define a &#39;water&#39; and an &#39;electricity&#39; commodity and we connect these to the nodes with <em>node__commodity</em> relations.</p><p><img src="../figs_two_hydro/two_hydro_commodities_graph.png" alt="Two hydro power plants in SpineOpt"/></p><h3 id="Flows-by-means-of-connections"><a class="docs-heading-anchor" href="#Flows-by-means-of-connections">Flows by means of connections</a><a id="Flows-by-means-of-connections-1"></a><a class="docs-heading-anchor-permalink" href="#Flows-by-means-of-connections" title="Permalink"></a></h3><p>We&#39;ll ensure a correct flow between the nodes through <em>connections</em>. The flows include:</p><ul><li>local inflows in the reservoirs,</li><li>internal flows in the hydro power plants (between the &#39;upper&#39; and &#39;lower&#39; nodes),</li><li>the discharge flow that exits the Språnget hydro power plant at the lower node and flows to the upper node of the Fallet hydro power plant,</li><li>the spill flow that bypasses the Språnget hydro power plant at the upper node and flows to the upper node of the Fallet hydro power plant,</li><li>the discharge flow that exits the Fallet hydro power plant at the lower node and flows to the downstream river,</li><li>the spill flow that bypasses the Fallet hydro power plant at the upper node and flows to the downstream river.</li></ul><p>For the local inflows in the reservoirs, we actually do not need a connection. Instead we can model this as a negative demand in one of the nodes of the power plant. For examlpe, consider an inflow of -112 for Språnget and one of -2 for Fallet.</p><p><img src="../figs_two_hydro/two_hydro_spranget_demand.png" alt="local inflows Spranget"/> <img src="../figs_two_hydro/two_hydro_fallet_demand.png" alt="local inflows Fallet"/></p><p>The flow within each hydro power plant, i.e. the discharge flow between the &#39;upper&#39; and the &#39;lower&#39; node to generate the electricity, will also not be handled by the connection but by the units. In fact, anything that happens between the &#39;upper&#39; and &#39;lower&#39; nodes will be handled by the units.</p><p>For each of the remaining flows we create a <em>connection</em> entity. These <em>connections</em> need to be connected to <em>nodes</em> to function properly. To that end we&#39;ll use the <em>connection__from_node</em>. As the name suggests, we connect the connection to the node where the flow comes from, e.g. the &#39;lower&#39; node of the Språnget hydro power plant to the connection between the &#39;lower&#39; node of the Språnget and the &#39;upper&#39; node of the Fallet hydro power plant. The result is shown in the picture below.</p><p><img src="../figs_two_hydro/two_hydro_connection_from_node.png" alt="connection__from_node"/></p><p>As the flows are unbound by default, we also need to define the relation between the nodes and the flows with the <em>connection__node_node</em> entities. We need one between the &#39;upper&#39; node of the Språnget hydro power plant and the &#39;upper&#39; node of the Fallet hydro power plant for the corresponding spill connection. We also need one between the &#39;lower&#39; node of the Språnget hydro power plant and the &#39;upper&#39; node of the Fallet hydro power plant for the corresponding discharge connection.</p><p><img src="../figs_two_hydro/two_hydro_connection_node_node.png" alt="connection__node_node"/></p><p>We bind the flows by setting the <em>fix<em>ratio</em>out<em>in</em>flow</em> to 1.0.</p><p><img src="../figs_two_hydro/two_hydro_connection_node_node_parameters.png" alt="connection__node_node parameters"/></p><p>The result should look like this:</p><p><img src="../figs_two_hydro/two_hydro_connections.png" alt="Flows through connections"/></p><h3 id="Energy-conversion-by-means-of-units"><a class="docs-heading-anchor" href="#Energy-conversion-by-means-of-units">Energy conversion by means of units</a><a id="Energy-conversion-by-means-of-units-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-conversion-by-means-of-units" title="Permalink"></a></h3><p>Each hydro power plant uses a <em>unit</em> to convert the flow of water to electricity. These units are connected to the &#39;upper&#39; and &#39;lower&#39; nodes of the hydro power plants and the &#39;electricity&#39; node. Water enters the &#39;upper&#39; node, so the &#39;upper&#39; node is connected to the unit through the <em>unit__from_node</em>. Water is then discharged, so the &#39;lower&#39; node is connected to the unit through the <em>unit__to_node</em>. As the water discharges, electricity is produced, so the &#39;electricity&#39; node is also connected to the unit through the <em>unit__to_node</em>. Below is a figure of these units. There is another unit connected to the electricity node but we&#39;ll get back to that later.</p><p><img src="../figs_two_hydro/two_hydro_unit_node.png" alt="units"/></p><p>Through the relations between the units and the nodes, we can set the capacity for the water flow and the electricity generation.</p><p>For example, the capacity of the water flow from the &#39;upper&#39; node to the the unit is 115 for Språnget and 165 for Fallet.</p><p><img src="../figs_two_hydro/two_hydro_flow_capacity.png" alt="flow capacity parameters"/></p><p>For example, the capacity of the electricity production from the unit to the &#39;electricity&#39; node is 112.2 for Fallet and 69 for Språnget.</p><p><img src="../figs_two_hydro/two_hydro_electric_capacity.png" alt="electric capacity parameters"/></p><p>Additionally, we add a unit to represent the income from selling the electricity production in the electricity market. The electricity price will be represented by a negative variable operation and maintenance (VOM) cost. That parameter needs to be set at the <em>unit__from_node</em> between the electricity node and the unit. Any (negative) value is fine, but we show an example below.</p><p><img src="../figs_two_hydro/two_hydro_vom_cost_parameter.png" alt="electricity price parameter"/></p><p><img src="../figs_two_hydro/two_hydro_vom_cost.png" alt="electricity price"/></p><p>Again, by default the flows are unbound, so we have to bind them with <em>unit__node_node</em> entities. The discharge flow from the &#39;upper&#39; node flows in its entirety to the &#39;lower&#39; node. As such the <em>unit__node_node</em> relation between the hydro power plant unit and the &#39;upper&#39; and &#39;lower&#39; node gets a value of 1.0 for the <em>fix_ratio_out_in_unit_flow</em>.</p><p><img src="../figs_two_hydro/two_hydro_unit_flow_capacity.png" alt="unit flow capacity"/></p><p>For the conversion from water flow to electricity, we need to take the conversion efficiency of the plant into account. For example, the <em>fix_ratio_out_in_unit_flow</em> for the <em>unit__node_node</em> entity between the unit, the &#39;upper&#39; node and the &#39;electricity&#39; node is 0.6 for the Språnget hydro power plant and 0.68 for the Fallet hydro power plant.</p><p><img src="../figs_two_hydro/two_hydro_unit_efficiency.png" alt="unit efficiency"/></p><p>The result should look like this:</p><p><img src="../figs_two_hydro/two_hydro_units_graph.png" alt="units"/></p><h3 id="Storage-in-nodes"><a class="docs-heading-anchor" href="#Storage-in-nodes">Storage in nodes</a><a id="Storage-in-nodes-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-in-nodes" title="Permalink"></a></h3><p>To model the reservoirs of each hydropower plant, we leverage the <em>state</em> feature that a node can have to represent storage capability. We only need to do this for one of the two nodes that we have used to model each plant and we choose the <em>upper</em> level node. To activate the storage functionality of a node, we set the value of the parameter <em>has_state</em> as True (be careful to not set it as a string but select the boolean true value). Then, we need to set the capacity of the reservoir by setting the <em>node_state_cap</em> parameter value.</p><p>Depending on the constraints of your hydro power plant, you can also fix the initial and final values of the reservoir by setting the parameter <em>fix_node_state</em> to the respective values (use <em>nan</em> values for the time steps that you don&#39;t want to impose such constraints). When fixing the initial value of a reservoir value, the value should be fixed at ‘t-1’ instead of ’t0’. That is because the initial value of a reservoir means the previous value before the first hour. </p><p><img src="../figs_two_hydro/two_hydro_spranget_storage.png" alt="storage Spranget"/> <img src="../figs_two_hydro/two_hydro_fallet_storage.png" alt="storage Fallet"/></p><h3 id="Examining-the-results"><a class="docs-heading-anchor" href="#Examining-the-results">Examining the results</a><a id="Examining-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Examining-the-results" title="Permalink"></a></h3><p>At this point the model should be ready to run and you can examine the results in the output database with the Spine DB editor.</p><h2 id="Maximisation-of-Stored-Water"><a class="docs-heading-anchor" href="#Maximisation-of-Stored-Water">Maximisation of Stored Water</a><a id="Maximisation-of-Stored-Water-1"></a><a class="docs-heading-anchor-permalink" href="#Maximisation-of-Stored-Water" title="Permalink"></a></h2><p>Instead of fixing the water content of the reservoirs at the end of the planning period, we can consider that the remaining water in the reservoirs has a value and then maximize the value along with the revenues for producing electricity within the planning horizon. This objective term is often called the <strong>Value of stored water</strong> and we can approximate it by assuming that this water will be used to generate electricity in the future that would be sold at a forecasted price. The water stored in the upstream hydropower plant will become also available to the downstream plant and this should be taken into account.</p><p>To model the value of stored water we need to make some additions and modifications to the initial model.</p><ul><li><p>First, add a new node (see <a href="../../#Nodes">adding nodes</a>) and give it a   name (e.g., <em>stored_water</em>). This   node will accumulate the water stored in the reservoirs at the end   of the planning horizon. Associate the node with the water   commodity (see <a href="../../#Assinging-commodities-to-nodes">node__commodity</a>).</p></li><li><p>Add three more units (see <a href="../../#Units">adding units</a>); two will   transfer the water at the end of the planning horizon in the new   node that we just added (e.g., <em>Språnget_stored_water</em>, <em>Fallet_stored_water</em>), and one will be   used as a <em>sink</em> introducing the   value of stored water in the objective function (e.g., <em>value_stored_water</em>).</p></li><li><p>To establish the topology of the new units and nodes (see   <a href="../../#Placing-the-units-in-the-model">adding unit relationships</a>):</p><ul><li>add one <em>unit__from_node</em> relationship, between the   <em>value_stored_water</em> unit from the <em>stored_water</em> node, another one between   the <em>Språnget_stored_water</em> unit from   the <em>Språnget_upper</em> node and one for   <em>Faller_stored_water</em> from <em>Fallet_upper</em>.</li><li>add one <em>unit__node__node</em>   relationship between the <em>Språnget_stored_water</em> unit with the   <em>stored_water</em> and <em>Språnget_upper</em> nodes and another one   for <em>Fallet_stored_water</em> unit   with the <em>stored_water</em> and <em>Fallet_upper</em> nodes,</li><li>add a <em>unit__to_node</em>   relationship between the <em>Fallet_stored_water</em> and the <em>stored_water</em> node and another one   between the <em>Språnget_stored_water</em> unit and the   <em>stored_water</em> node.</li></ul></li><li><p>Now we need to make some changes in object parameter values.</p><ul><li>Extend the planning horizon of the model by one time step</li><li>Remove the <em>fix_node_state</em>   parameter values for the end of the optimization horizon as   you seen in the following figure: double click on the <em>value</em> cell of the <em>Språnget_upper</em> and <em>Fallet_upper</em> nodes, select the third   data row, right-click, select <em>Remove   rows</em>, and click OK.</li><li>Add an electricity price for the extra time step. Enter the   parameter <em>vom_cost</em> on the <em>unit__from_node</em> relationship   between the <em>electricity_node</em>   and the <em>electricity_load</em> and   set 0 as the price of electricity for the last time step. The price is set   to zero to ensure no electricity is sold during this hour.</li></ul></li><li><p>Finally, we need to add some relationship parameter values for the   new units:</p><ul><li>Add a <em>vom_cost</em> parameter value   on a <em>value_stored_water|stored_water</em>   instance of a <em>unit__from_node</em>   relationship, as you see in the figure bellow. For the   timeseries we have   imposed a zero cost for all the optimisation horizon, while we   use an assumed future electricity value for the additional   time step at the end of the horizon.</li></ul><p><img src="../figs_two_hydro/two_hydro_max_stored_water_unit_values.png" alt="Adding vom_cost parameter value on the value_stored_water unit."/></p><ul><li>Add two <em>fix_ratio_out_in_unit_flow</em> parameter   values as you see in the figure bellow. The efficiency of   <em>Fallet_stored_water</em> is the same   as the <em>Fallet_pwr_plant</em> as the   water in Fallet&#39;s reservoir will be used to produce   electricity by the the Fallet plant only. On the other hand,   the water from Språnget&#39;s reservoir will be used both by   Fallet and Språnget plant, therefore we use the sum of the two   efficiencies in the parameter value of <em>Språnget_stored_water</em>.</li></ul><p><img src="../figs_two_hydro/two_hydro_max_stored_water_unit_node_node.png" alt="Adding fix_ratio_out_in_unit_flow parameter values on the Språnget_stored_water and Fallet_stored_water units."/></p></li></ul><p>You can now commit your changes in the database, execute the project and <a href="../../#Examining-the-results">examine the results</a>! As an exercise, try to retrieve the value of stored water as it is calculated by the model.</p><h2 id="Spillage-Constraints-Minimisation-of-Spilt-Water"><a class="docs-heading-anchor" href="#Spillage-Constraints-Minimisation-of-Spilt-Water">Spillage Constraints - Minimisation of Spilt Water</a><a id="Spillage-Constraints-Minimisation-of-Spilt-Water-1"></a><a class="docs-heading-anchor-permalink" href="#Spillage-Constraints-Minimisation-of-Spilt-Water" title="Permalink"></a></h2><p>It might be the case that we need to impose certain limits to the amount of water that is spilt on each time step of the planning horizon, e.g., for environmental reasons, there can be a minimum and a maximum spillage level. At the same time, to avoid wasting water that could be used for producing electricity, we could explicitly impose the spillage minimisation to be added in the objective function.</p><ul><li><p>Add one unit (see <a href="../../#Units">adding units</a>) to impose the spillage   constraints to each plant and name it (for example <em>Språnget_spill</em>).</p></li><li><p>Remove the <em>Språnget_to_Fallet_spill</em>   connection (in the Object tree expand the connection class,   right-click on <em>Språnget_to_Fallet_spill</em>, and the click   <strong>Remove</strong>).</p></li><li><p>To establish the topology of the unit (see   <a href="../../#Placing-the-units-in-the-model">adding unit relationships</a>):</p><ul><li>Add a <em>unit__from_node</em>   relationship, between the <em>Språnget_spill</em> unit from the <em>Språnget_upper</em> node,</li><li>add a <em>unit__node__node</em>   relationship between the <em>Språnget_spill</em> unit with the <em>Fallet_upper</em> and <em>Språnget_upper</em> nodes,</li><li>add a <em>unit__to_node</em>   relationship between the <em>Språnget_spill</em> and the <em>Fallet_upper</em> node,</li></ul></li><li><p>Add the relationship parameter values for the new units:</p><ul><li>Set the <em>unit_capacity</em> (to apply a   maximum), the <em>minimum_operating_point</em> (defined as a   percentage of the <em>unit_capacity</em>)   to impose a minimum, and the <em>vom_cost</em> to penalise the water that is   spilt:</li></ul><p><img src="../figs_two_hydro/two_hydro_min_spill_unit_node_node.png" alt="Setting minimum (the minimal value is defined as percentage of capacity), maximum, and spillage penalty."/></p></li></ul><ul><li>For the <em>Språnget_spill</em> unit   define the <em>fix_ratio_out_in_unit_flow</em> parameter   value of the <em>min_spillage|Fallet_upper|Språnget_upper</em>   relationship to <strong>1</strong> (see   <a href="../../#Placing-the-units-in-the-model">adding unit relationships</a>).</li></ul><p>Commit your changes in the database, execute the project and <a href="../../#Examining-the-results">examine the results</a>! As an exercise, you can perform this process for and Fallet plant (you would also need to add another water node, downstream of Fallet).</p><h2 id="Follow-Contracted-Load-Curve"><a class="docs-heading-anchor" href="#Follow-Contracted-Load-Curve">Follow Contracted Load Curve</a><a id="Follow-Contracted-Load-Curve-1"></a><a class="docs-heading-anchor-permalink" href="#Follow-Contracted-Load-Curve" title="Permalink"></a></h2><p>It is often the case that a system of hydropower plants should follow a given production profile. To model this in the given system, all we have to do is set a demand in the form of a timeseries to the <em>electricity_node</em>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../manage_output/">« Manage output</a><a class="docs-footer-nextpage" href="../print_the_model/">Print the model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 3 March 2025 13:31">Monday 3 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
