<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Decomposition · SpineOpt.jl</title><meta name="title" content="Decomposition · SpineOpt.jl"/><meta property="og:title" content="Decomposition · SpineOpt.jl"/><meta property="twitter:title" content="Decomposition · SpineOpt.jl"/><meta name="description" content="Documentation for SpineOpt.jl."/><meta property="og:description" content="Documentation for SpineOpt.jl."/><meta property="twitter:description" content="Documentation for SpineOpt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SpineOpt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpineOpt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/recommended_workflow/">Verify installation</a></li><li><a class="tocitem" href="../../getting_started/troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../../getting_started/performance_tips/">Performace tips</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorial/webinars/">Webinars</a></li><li><a class="tocitem" href="../../tutorial/simple_system/">Simple system</a></li><li><a class="tocitem" href="../../tutorial/temporal_resolution/">Temporal resolution</a></li><li><a class="tocitem" href="../../tutorial/stochastic_system/">Stochastic structure</a></li><li><a class="tocitem" href="../../tutorial/capacity_planning/">Capacity planning</a></li><li><a class="tocitem" href="../../tutorial/multi-year_investment/">Multi-year investments using economic parameters</a></li><li><a class="tocitem" href="../../tutorial/reserves/">Reserve requirements</a></li><li><a class="tocitem" href="../../tutorial/ramping/">Ramping constraints</a></li><li><a class="tocitem" href="../../tutorial/unit_commitment/">Unit Commitment</a></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../../how_to/change_the_solver/">Change the solver</a></li><li><a class="tocitem" href="../../how_to/compile_julia_system_image/">Compile julia system image</a></li><li><a class="tocitem" href="../../how_to/define_an_efficiency/">Define an efficiency</a></li><li><a class="tocitem" href="../../how_to/impose_renewable_energy_targets/">Impose renewable energy targets</a></li><li><a class="tocitem" href="../../how_to/manage_output/">Manage output</a></li><li><a class="tocitem" href="../../how_to/model_hydro_power_coupling/">Model hydro power coupling</a></li><li><a class="tocitem" href="../../how_to/print_the_model/">Print the model</a></li><li><a class="tocitem" href="../../how_to/set_up_representative_days_for_investment_problems/">Set up representative days for investment problems</a></li></ul></li><li><a class="tocitem" href="../../gallery/gallery/">Example gallery</a></li><li><span class="tocitem">Database structure</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the data structure</a></li><li><a class="tocitem" href="../../concept_reference/archetypes/">Archetypes</a></li></ul></li><li><span class="tocitem">Standard model framework</span><ul><li><a class="tocitem" href="../temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../stochastic_framework/">Stochastic Framework</a></li></ul></li><li><span class="tocitem">Standard model features</span><ul><li><a class="tocitem" href="../unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../multi-year/">Multi-year Investments</a></li><li><a class="tocitem" href="../reserves/">Reserves</a></li><li><a class="tocitem" href="../ramping/">Ramping</a></li><li><a class="tocitem" href="../Lossless_DC_power_flow/">Lossless nodal DC power flows</a></li><li><a class="tocitem" href="../powerflow/">PTDF-Based Powerflow</a></li><li><a class="tocitem" href="../pressure_driven_gas_transfer/">Pressure driven gas transfer</a></li><li><a class="tocitem" href="../user_constraints/">User Constraints</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li class="is-active"><a class="tocitem" href>Decomposition</a><ul class="internal"><li><a class="tocitem" href="#High-level-Decomposition-Algorithm"><span>High-level Decomposition Algorithm</span></a></li><li><a class="tocitem" href="#Duals-and-reduced-costs-calculation-for-decomposition"><span>Duals and reduced costs calculation for decomposition</span></a></li><li><a class="tocitem" href="#Reporting-dual-values-and-reduced-costs"><span>Reporting dual values and reduced costs</span></a></li><li><a class="tocitem" href="#Using-Decomposition"><span>Using Decomposition</span></a></li></ul></li><li><a class="tocitem" href="../mga/">Modelling to generate alternatives</a></li><li><a class="tocitem" href="../multi_stage/">Multi-stage optimisation</a></li></ul></li><li><span class="tocitem">SpineOpt Template</span><ul><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints_automatically_generated/">Constraints</a></li></ul></li><li><span class="tocitem">Implementation details</span><ul><li><a class="tocitem" href="../../implementation_details/documentation/">Documentation</a></li><li><a class="tocitem" href="../../implementation_details/how_does_the_model_update_itself/">How does the model update itself</a></li><li><a class="tocitem" href="../../implementation_details/how_to_write_a_constraint/">How to write a constraint</a></li><li><a class="tocitem" href="../../implementation_details/time_slices/">Time slices</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Algorithms</a></li><li class="is-active"><a href>Decomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Decomposition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl/blob/master/docs/src/advanced_concepts/decomposition.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Decomposition"><a class="docs-heading-anchor" href="#Decomposition">Decomposition</a><a id="Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Decomposition" title="Permalink"></a></h1><p>Decomposition approaches take advantage of certain problem structures to separate them into multiple related problems which are each more easily solved. Decomposition also allows us to do the inverse, which is to combine independent problems into a single problem, where each can be solved separately but with communication between them (e.g. investments and operations problems)</p><p>Decomposition thus allows us to do a number of things</p><ul><li>Solve larger problems which are otherwise intractable</li><li>Include more detail in problems which otherwise need to be simplified</li><li>Combine related problems (e.g. investments/operations) in a more scientific way (rather than ad-hoc).</li><li>Employ parallel computing methods to solve multiple problems simultaneously.</li></ul><h2 id="High-level-Decomposition-Algorithm"><a class="docs-heading-anchor" href="#High-level-Decomposition-Algorithm">High-level Decomposition Algorithm</a><a id="High-level-Decomposition-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#High-level-Decomposition-Algorithm" title="Permalink"></a></h2><p>The high-level algorithm is described below. For a more detailed description please see <a href="@ref benders_decomposition">Benders decomposition</a></p><ul><li>Model initialisation (preprocess<em>data</em>structure, generate temporal structures etc.)</li><li>For each benders_iteration<ul><li>Solve master problem</li><li>Process master-problem solution:<ul><li>set <code>units_invested_bi(unit=u)</code> equal to the investment variables solution from the master problem</li></ul></li><li>Solve operations problem loop</li><li>Process operations sub-problem<ul><li>set <code>units_on_mv(unit=u)</code> equal to the marginal value of the units_on bound constraint</li></ul></li><li>Test for convergence</li><li>Update master problem<ul><li>Add <a href="@ref constraint_mp_any_invested_cuts">Benders cuts constraints</a></li></ul></li><li>Rewind operations problem</li><li>Next benders iteration</li></ul></li></ul><h2 id="Duals-and-reduced-costs-calculation-for-decomposition"><a class="docs-heading-anchor" href="#Duals-and-reduced-costs-calculation-for-decomposition">Duals and reduced costs calculation for decomposition</a><a id="Duals-and-reduced-costs-calculation-for-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Duals-and-reduced-costs-calculation-for-decomposition" title="Permalink"></a></h2><p>The marginal values above are computed as the reduced costs of relevant optimisation variables. However, the dual solution to a MIP problem is not well defined. The standard approach to obtaining marginal values from a MIP model is to relax the integer variables, fix them to their last solution value and re-solve the problem as an LP. This is the standard approach in energy system modelling to obtain energy prices. However, although this is the standard approach, it does need to be used with caution. The main hazard associated with inferring duals in this way is that the impact on costs of an investment may be overstated. However, since these duals are used in Benders decomposition to obtain a lower bound on costs (i.e. the maximum potential value from an investment), this is ok and can be &quot;corrected&quot; in the next iteration. And finally, the benders gap will tell us how close our decomposed problem is to the optimal global solution.</p><h2 id="Reporting-dual-values-and-reduced-costs"><a class="docs-heading-anchor" href="#Reporting-dual-values-and-reduced-costs">Reporting dual values and reduced costs</a><a id="Reporting-dual-values-and-reduced-costs-1"></a><a class="docs-heading-anchor-permalink" href="#Reporting-dual-values-and-reduced-costs" title="Permalink"></a></h2><p>To report the dual of a constraint, one can add an output item with the corresponding constraint name (e.g. <code>constraint_nodal_balance</code>) and add that to a report. This will cause the corresponding constraint&#39;s relaxed problem marginal value will be reported in the output DB. When adding a constraint name as an output we need to preface the actual constraint name with <code>constraint_</code> to avoid ambiguity with variable names (e.g. <code>units_available</code>). So to report the marginal value of <code>units_available</code> we add an output object called <code>constraint_units_available</code>.</p><p>To report the reduced cost for a variable which is the marginal value of the associated active bound or fix constraints on that variable, one can add an output object with the variable name prepended by <code>bound_</code>. So, to report the units<em>on reduced</em>cost value, one would create an output item called <code>bound_units_on</code>. If added to a report, this will cause the reduced cost of <a href="../../mathematical_formulation/variables/#units_on">units_on</a> in the final fixed LP to be written to the output db.</p><h2 id="Using-Decomposition"><a class="docs-heading-anchor" href="#Using-Decomposition">Using Decomposition</a><a id="Using-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Decomposition" title="Permalink"></a></h2><p>Assuming one has set up a conventional investments problem as described in <a href="../investment_optimization/#Investment-Optimization">Investment Optimization</a> the following additional steps are required to utilise the decomposition framework:</p><ul><li>Set the <a href="../../concept_reference/Parameters/#model_type">model_type</a> parameter for your <code>model</code> to <code>spineopt_benders</code>.</li><li>Specify <a href="../../concept_reference/Parameters/#max_gap">max_gap</a> parameter for your <code>model</code> - This determines the master problem convergence criterion for the relative benders gap. A value of 0.05 will represent a relative benders gap of 5%.</li><li>Specify the <a href="@ref">max_iterations</a> parameter for your <code>model</code> - This determines the master problem convergence criterion for the number of iterations. A value of 10 could be appropriate but this is highly dependent on the size and nature of the problem.</li></ul><p>Once the above is set, all investment decisions in the model are automatically decomposed and optimised in a Benders master problem. This behaviour may change in the future to allow some investment decisions to be optimised in the operations problem and some optimised in the master problem as desired.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../user_constraints/">« User Constraints</a><a class="docs-footer-nextpage" href="../mga/">Modelling to generate alternatives »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 3 March 2025 18:40">Monday 3 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
