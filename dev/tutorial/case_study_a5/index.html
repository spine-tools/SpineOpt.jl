<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Case Study A5 · SpineOpt.jl</title><meta name="title" content="Case Study A5 · SpineOpt.jl"/><meta property="og:title" content="Case Study A5 · SpineOpt.jl"/><meta property="twitter:title" content="Case Study A5 · SpineOpt.jl"/><meta name="description" content="Documentation for SpineOpt.jl."/><meta property="og:description" content="Documentation for SpineOpt.jl."/><meta property="twitter:description" content="Documentation for SpineOpt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SpineOpt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpineOpt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/setup_workflow/">Setting up a workflow</a></li><li><a class="tocitem" href="../../getting_started/creating_your_own_model/">Creating Your Own Model</a></li><li><a class="tocitem" href="../../getting_started/archetypes/">Archetypes</a></li><li><a class="tocitem" href="../../getting_started/output_data/">Managing Outputs</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../webinars/">Webinars</a></li><li><a class="tocitem" href="../simple_system/">Simple system</a></li><li><a class="tocitem" href="../reserves/">Reserve requirements</a></li><li><a class="tocitem" href="../ramping/">Ramping constraints</a></li><li><a class="tocitem" href="../unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../tutorialTwoHydro/">Two hydro plants</a></li><li class="is-active"><a class="tocitem" href>Case Study A5</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Entering-data"><span>Entering data</span></a></li><li><a class="tocitem" href="#Executing-the-workflow"><span>Executing the workflow</span></a></li><li><a class="tocitem" href="#Examining-the-results"><span>Examining the results</span></a></li></ul></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../../how_to/change_the_solver/">Change the solver</a></li><li><a class="tocitem" href="../../how_to/define_an_efficiency/">Define an efficiency</a></li><li><a class="tocitem" href="../../how_to/print_the_model/">Print the model</a></li></ul></li><li><span class="tocitem">Concept Reference</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the model structure</a></li><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints_automatically_generated/">Constraints</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li></ul></li><li><span class="tocitem">Advanced Concepts</span><ul><li><a class="tocitem" href="../../advanced_concepts/temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/stochastic_framework/">Stochastic Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../../advanced_concepts/ramping/">Ramping</a></li><li><a class="tocitem" href="../../advanced_concepts/reserves/">Reserves</a></li><li><a class="tocitem" href="../../advanced_concepts/investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../../advanced_concepts/user_constraints/">User Constraints</a></li><li><a class="tocitem" href="../../advanced_concepts/decomposition/">Decomposition</a></li><li><a class="tocitem" href="../../advanced_concepts/powerflow/">PTDF-Based Powerflow</a></li><li><a class="tocitem" href="../../advanced_concepts/pressure_driven_gas_transfer/">Pressure driven gas transfer</a></li><li><a class="tocitem" href="../../advanced_concepts/Lossless_DC_power_flow/">Lossless nodal DC power flows</a></li><li><a class="tocitem" href="../../advanced_concepts/representative_days_w_seasonal_storage/">Representative days with seasonal storages</a></li><li><a class="tocitem" href="../../advanced_concepts/cumulated_flow_restrictions/">Imposing renewable energy targets</a></li><li><a class="tocitem" href="../../advanced_concepts/mga/">Modelling to generate alternatives</a></li><li><a class="tocitem" href="../../advanced_concepts/multi_stage/">Multi-stage optimisation</a></li></ul></li><li><span class="tocitem">Implementation details</span><ul><li><a class="tocitem" href="../../implementation_details/documentation/">Documentation</a></li><li><a class="tocitem" href="../../implementation_details/how_does_the_model_update_itself/">How does the model update itself</a></li><li><a class="tocitem" href="../../implementation_details/how_to_write_a_constraint/">How to write a constraint</a></li><li><a class="tocitem" href="../../implementation_details/time_slices/">Time slices</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Case Study A5</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Case Study A5</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl/blob/master/docs/src/tutorial/case_study_a5.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Case-Study-A5-tutorial"><a class="docs-heading-anchor" href="#Case-Study-A5-tutorial">Case Study A5 tutorial</a><a id="Case-Study-A5-tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Case-Study-A5-tutorial" title="Permalink"></a></h1><p>Welcome to this Spine Toolbox Case Study tutorial. Case Study A5 is one of the Spine Project case studies designed to verify Toolbox and Model capabilities. To this end, it <em>reproduces</em> an already existing study about hydropower on the <a href="https://en.wikipedia.org/wiki/Skellefte_River">Skellefte river</a>, which models one week of operation of the fifteen power stations along the river.</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><h3 id="Model-assumptions"><a class="docs-heading-anchor" href="#Model-assumptions">Model assumptions</a><a id="Model-assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Model-assumptions" title="Permalink"></a></h3><p>For each power station in the river, the following information is known:</p><ul><li>The capacity, or maximal electricity output. This datum also   provides the maximal water discharge as per the efficiency curve   (see next point).</li><li>The efficiency curve, or conversion rate from water to electricity.   In this study, a piece-wise linear efficiency with two segments is   assumed. Moreover, this curve is monotonically decreasing, i.e., the   efficiency in the first segment is strictly greater than the   efficiency in the second segment.</li><li>The maximal reservoir level (maximal amount of water that can be   stored in the reservoir).</li><li>The reservoir level at the beginning of the simulation period and at   the end.</li><li>The minimal amount of water that the plant must discharge at every   hour. This is usually zero (except for one of the plants).</li><li>The downstream plant, or next plant in the river course.</li><li>The time that it takes for the water to reach the downstream plant.   This time can be different depending on whether the water is   discharged (goes through the turbine) or spilled.</li><li>The local inflow, or amount of water that naturally enters the   reservoir at every hour. In this study, it is assumed constant over   the entire simulation period.</li><li>The hourly average water discharge. It is assumed that before the   beginning of the simulation, this amount of water has constantly   been discharged at every hour.</li></ul><p>The system is operated so as to maximize the total profit over the planning week, while respecting capacity constraints, maximal reservoir level constrains, etc. Hourly profit per plant is simply computed as the product of the electricity price and the production.</p><h3 id="Modelling-choices"><a class="docs-heading-anchor" href="#Modelling-choices">Modelling choices</a><a id="Modelling-choices-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-choices" title="Permalink"></a></h3><p>The model of the electric system is fairly simple, only two elements are needed:</p><ul><li>A common electricity node.</li><li>A load unit that takes electricity from that node.</li></ul><p>On the contrary, the model of the river system is more detailed. Each power station in the river is modelled using the following elements:</p><ul><li>An upper water node, located at the entrance of the station.</li><li>A lower water node, located at the exit of the station.</li><li>A power plant unit, that discharges water from the upper node into   the lower node, and feeds electricity produced in the process to the   common electricity node.</li><li>A spillway connection, that takes spilled water from the upper node   and releases it to the downstream upper node.</li><li>A discharge connection, that takes water from the lower node and   releases it to the downstream upper node.</li></ul><p>Below is a schematic of the model. For clarity, only the Rebnis station is presented in full detail:</p><p><img src="../figs_a5/case_study_a5_schematic.png" alt="image"/></p><p>In order to run this tutorial you must first execute some preliminary steps from the <a href="../simple_system/">Simple System</a> tutorial. Specifically, execute all steps from the <a href="../simple_system/#guide">guide</a>, up to and including the step of <a href="../simple_system/#importing-the-spineopt-database-template">importing the spineopt database template</a>. It is advisable to go through the whole tutorial in order to familiarise yourself with Spine.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Just remember to give a different name for the Spine Project of the hydropower tutorial (e.g., ‘Case Study A5’) in the corresponding step, so to not mix up the Spine Toolbox projects!</p></div></div><h3 id="Importing-the-SpineOpt-database-template"><a class="docs-heading-anchor" href="#Importing-the-SpineOpt-database-template">Importing the SpineOpt database template</a><a id="Importing-the-SpineOpt-database-template-1"></a><a class="docs-heading-anchor-permalink" href="#Importing-the-SpineOpt-database-template" title="Permalink"></a></h3><ul><li>Download <a href="https://raw.githubusercontent.com/spine-tools/SpineOpt.jl/master/templates/spineopt_template.json">the SpineOpt database template</a> (right click on the link, then select <em>Save link as...</em>)</li><li>Select the <em>input</em> Data Store item in the <em>Design View</em>.</li><li>Go to <em>Data Store Properties</em> and hit <strong>Open editor</strong>. This will open the newly created database in the <em>Spine DB Editor</em>, looking similar to image below.   <img src="../figs_a5/case_study_a5_spine_db_editor_empty.png" alt="image"/></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The Spine DB editor is a dedicated interface within Spine Toolbox for visualizing and managing Spine databases.</p></div></div><ul><li>Press <strong>Alt + F</strong> to display the editor menu, select <strong>File -&gt; Import...</strong>,    and then select the template file you previously   downloaded (in case it is not displayed in the folder where you   saved it, double-check that you selected). The contents of that file   will be imported into the current database, and you should then see   classes like ‘commodity’, ‘connection’ and ‘model’ under the root   node in the <em>Object tree</em> (on the left).</li><li>From the editor menu (Alt + F), select <strong>Session -&gt; Commit</strong>. Enter   ‘Import SpineOpt template’ as message in the popup dialog, and click   <strong>Commit</strong>.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The SpineOpt template contains the fundamental object and relationship classes, as well as parameter definitions, that SpineOpt recognizes and expects. You can think of it as the <em>generic structure</em> of the model, as opposed to the <em>specific data</em> for a particular instance. In the remainder of this section, we will add that specific data for the Skellefte river.</p></div></div><h2 id="Entering-data"><a class="docs-heading-anchor" href="#Entering-data">Entering data</a><a id="Entering-data-1"></a><a class="docs-heading-anchor-permalink" href="#Entering-data" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There are two options in this tutorial to enter data in the Database. The first one is to enter data manually and the second to <a href="../../#Using-the-Importer">use the importer</a> functionality. These are described in the next two subsections respectively and produce similar models. The model created when using the importer creates a model with two-segments efficiency curves for converting water to electricity (while the model created when entering the data manually assumes a simplified efficiency curve with a single segment).</p></div></div><h3 id="Entering-data-manually"><a class="docs-heading-anchor" href="#Entering-data-manually">Entering data manually</a><a id="Entering-data-manually-1"></a><a class="docs-heading-anchor-permalink" href="#Entering-data-manually" title="Permalink"></a></h3><h4 id="Creating-objects"><a class="docs-heading-anchor" href="#Creating-objects">Creating objects</a><a id="Creating-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-objects" title="Permalink"></a></h4><ul><li><p>To add power plants to the model, stay in the <em>Spine DB Editor</em> and create objects of class <code>unit</code> as follows:</p><ul><li>Select the list of plant names from the text-box below and copy it to the clipboard (<strong>Ctrl+C</strong>)<pre><code class="nohighlight hljs">  Rebnis_pwr_plant
  Sadva_pwr_plant
  Bergnäs_pwr_plant
  Slagnäs_pwr_plant
  Bastusel_pwr_plant
  Grytfors_pwr_plant
  Gallejaur_pwr_plant
  Vargfors_pwr_plant
  Rengård_pwr_plant
  Båtfors_pwr_plant
  Finnfors_pwr_plant
  Granfors_pwr_plant
  Krångfors_pwr_plant
  Selsfors_pwr_plant
  Kvistforsen_pwr_plant</code></pre></li><li>Go to <em>Object tree</em> (on the top left of the window, usually), right-click on <code>unit</code> and select <strong>Add objects</strong> from the context menu. This will open the <em>Add objects</em> dialog.</li><li>Select the first cell under the <strong>object name</strong> column and press <strong>Ctrl+V</strong>. This will paste the list of plant names from the clipboard into that column; the <strong>object class name</strong> column will be filled automatically with ‘unit‘. The form should now be looking similar to this:   <img src="../figs_a5/add_power_plant_units.png" alt="image"/></li><li>Click <strong>Ok</strong>.</li><li>Back in the <em>Spine DB Editor</em>, under <em>Object tree</em>, double click on <code>unit</code> to confirm that the objects are effectively there.</li><li>Commit changes with the message ‘Add power plants’.</li></ul></li><li><p>Add discharge and spillway connections by creating objects of class <code>connection</code> with the following names:</p><p>Rebnis<em>to</em>Bergnäs<em>disch   Sadva</em>to<em>Bergnäs</em>disch   Bergnäs<em>to</em>Slagnäs<em>disch   Slagnäs</em>to<em>Bastusel</em>disch   Bastusel<em>to</em>Grytfors<em>disch   Grytfors</em>to<em>Gallejaur</em>disch   Gallejaur<em>to</em>Vargfors<em>disch   Vargfors</em>to<em>Rengård</em>disch   Rengård<em>to</em>Båtfors<em>disch   Båtfors</em>to<em>Finnfors</em>disch   Finnfors<em>to</em>Granfors<em>disch   Granfors</em>to<em>Krångfors</em>disch   Krångfors<em>to</em>Selsfors<em>disch   Selsfors</em>to<em>Kvistforsen</em>disch   Kvistforsen<em>to</em>downstream<em>disch   Rebnis</em>to<em>Bergnäs</em>spill   Sadva<em>to</em>Bergnäs<em>spill   Bergnäs</em>to<em>Slagnäs</em>spill   Slagnäs<em>to</em>Bastusel<em>spill   Bastusel</em>to<em>Grytfors</em>spill   Grytfors<em>to</em>Gallejaur<em>spill   Gallejaur</em>to<em>Vargfors</em>spill   Vargfors<em>to</em>Rengård<em>spill   Rengård</em>to<em>Båtfors</em>spill   Båtfors<em>to</em>Finnfors<em>spill   Finnfors</em>to<em>Granfors</em>spill   Granfors<em>to</em>Krångfors<em>spill   Krångfors</em>to<em>Selsfors</em>spill   Selsfors<em>to</em>Kvistforsen<em>spill   Kvistforsen</em>to<em>downstream</em>spill</p></li><li><p>Add water nodes by creating objects of class <code>node</code> with the following names:</p><p>Rebnis<em>upper   Sadva</em>upper   Bergnäs<em>upper   Slagnäs</em>upper   Bastusel<em>upper   Grytfors</em>upper   Gallejaur<em>upper   Vargfors</em>upper   Rengård<em>upper   Båtfors</em>upper   Finnfors<em>upper   Granfors</em>upper   Krångfors<em>upper   Selsfors</em>upper   Kvistforsen<em>upper   Rebnis</em>lower   Sadva<em>lower   Bergnäs</em>lower   Slagnäs<em>lower   Bastusel</em>lower   Grytfors<em>lower   Gallejaur</em>lower   Vargfors<em>lower   Rengård</em>lower   Båtfors<em>lower   Finnfors</em>lower   Granfors<em>lower   Krångfors</em>lower   Selsfors<em>lower   Kvistforsen</em>lower</p></li><li><p>Next, create the following objects (all names in <strong>lower-case</strong>):</p><ul><li><code>instance</code> of class <code>model</code>.</li><li><code>water</code> and <code>electricity</code> of class <code>commodity</code>.</li><li><code>electricity_node</code> of class <code>node</code>.</li><li><code>electricity_load</code> of class <code>unit</code>.</li><li><code>some_week</code> of class <code>temporal_block</code>.</li><li><code>deterministic</code> of class <code>stochastic_structure</code>.</li><li><code>realization</code> of class <code>stochastic_scenario</code>.</li></ul></li><li><p>Finally, create the following objects to get results back from SpineOpt (again, all names in <strong>lower-case</strong>):</p><ul><li><code>my_report</code> of class <code>report</code>.</li><li><code>unit_flow</code>, <code>connection_flow</code>, and <code>node_state</code> of class <code>output</code>.</li></ul></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To modify an object after you enter it, right click on it and select <strong>Edit...</strong> from the context menu.</p></div></div><h4 id="Specifying-object-parameter-values"><a class="docs-heading-anchor" href="#Specifying-object-parameter-values">Specifying object parameter values</a><a id="Specifying-object-parameter-values-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-object-parameter-values" title="Permalink"></a></h4><ul><li><p>To specify the general behaviour of our model, stay in the <em>Spine DB   Editor</em> and enter model parameter values as follows:</p><ul><li>Select the model parameter value data (i.e. select all, <strong>Ctrl+A</strong>) from the file below and copy it to the clipboard (<strong>Ctrl+C</strong>):   <a href="../data/cs-a5-model-parameter-values.txt">cs-a5-model-parameter-values.txt</a></li><li>Select <code>instance</code> in the <em>Object tree</em> and inspect the table in <em>Object parameter value</em> (on the top-center of the window, usually). Make sure that the columns in the table are ordered as follows (drag and drop columns if you need to change their order): </li></ul><pre><code class="nohighlight hljs">  object_class_name | object_name | parameter_name | alternative_name | value | database</code></pre><ul><li>Select the first cell under <code>object_class_name</code> and press <strong>Ctrl+V</strong>. This will paste the model parameter value data from the clipboard into the table. The form should be looking like this:   <img src="../figs_a5/case_study_a5_model_parameters.png" alt="image"/></li></ul></li><li><p>Specify the resolution of our temporal block <code>some_week</code> in the same   way using the data below:   <a href="../data/cs-a5-temporal_block-parameter-values.txt">cs-a5-temporal_block-parameter-values.txt</a></p></li><li><p>Specify the behaviour of all system nodes with the data below, where:</p><ul><li><code>demand</code> represents the local inflow (negative in most cases).</li><li><code>fix_node_state</code> represents fixed reservoir levels (at the   beginning and the end).</li><li><code>has_state</code> indicates whether or not the node is a reservoir   (true for all the upper nodes).</li><li><code>state_coeff</code> is the reservoir &#39;efficienty&#39; (always 1, meaning   that there aren&#39;t any loses).</li><li><code>node_state_cap</code> is the maximum level of the reservoirs.</li></ul><p>To do this in one single step, simply select <code>node</code> in the <em>Object tree</em> and paste the following values in the first empty cell:    <a href="../data/cs-a5-node-parameter-values.txt">cs-a5-node-parameter-values.txt</a></p></li></ul><h4 id="Establishing-relationships"><a class="docs-heading-anchor" href="#Establishing-relationships">Establishing relationships</a><a id="Establishing-relationships-1"></a><a class="docs-heading-anchor-permalink" href="#Establishing-relationships" title="Permalink"></a></h4><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>To enter the same text on several cells, copy the text into the clipboard, then select all target cells and press <strong>Ctrl+V</strong>.</p></div></div><ul><li><p>Create relationships of the class <code>unit__from_node</code> to represent   that a power plant receives water from the station&#39;s upper water   node, and that the electricity load takes electricity from the   common electricity node. Both the power plants and the electricity   load belong to the class <code>unit</code>.</p><ul><li>Select the list of unit and node names from below and copy it to the clipboard (<strong>Ctrl+C</strong>).   <a href="../data/cs-a5-unit__from_node.txt">cs-a5-unit__from_node.txt</a></li><li>In the <em>Spine DB Editor</em>, go to <em>Relationship tree</em> (on the   bottom left of the window, usually), right-click on   <code>unit__from_node</code> and select <strong>Add relationships</strong> from the   context menu. This will open the <em>Add relationships</em> dialog.</li><li>Select the first cell under the <em>unit</em> column and press   <strong>Ctrl+V</strong>. This will paste the list of plant and node names   from the clipboard into the table. The form should be looking   like this:   <img src="../figs_a5/add_pwr_plant_water_from_node.png" alt="image"/> </li><li>Click <strong>Ok</strong>.</li><li>Back in the <em>Spine DB Editor</em>, under <em>Relationship tree</em>, double   click on <code>unit__from_node</code> to confirm that the relationships are   effectively there.</li><li>From the main menu (<strong>Alt + F</strong>), select <strong>Session -&gt; Commit</strong>   to open the <em>Commit changes</em> dialog. Enter ‘Add from nodes of   power plants‘ as the commit message and click <strong>Commit</strong>.</li></ul></li><li><p>Create relationships of the class <code>unit__to_node</code> to represent that   a power plant releases water to the station&#39;s lower water node, and   that the power plants supply electricity to the common electricity   node. Use the following data and do as before:   <a href="../data/cs-a5-unit__to_node.txt">cs-a5-unit__to_node.txt</a></p></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>At this point, you might be wondering what&#39;s the purpose of the <code>unit__node__node</code> relationship class. Shouldn&#39;t it be enough to have <code>unit__from_node</code> and <code>unit__to_node</code> to represent the topology of the system? The answer is yes; but in addition to topology, we also need to represent the <em>conversion process</em> that happens in the unit, where the water from one node is turned into electricty for another node. And for this purpose, we use a relationship parameter value on the <code>unit__node__node</code> relationships (see <code>Specifying relationship parameter values</code>).</p></div></div><ul><li><p>Create relationships of the class <code>connection__from_node</code> to   represent that water can be either discharged or spilled. If   discharged, it is taken from the <em>lower</em> water node of the station,   if spilled it is taken from the <em>upper</em> water node of the station.   Use the following data and do as before:   <a href="../data/cs-a5-connection__from_node.txt">cs-a5-connection__from_node.txt</a></p></li><li><p>Create relationships of the class <code>connection__to_node</code> to represent   that both discharge and spill are released into the <em>upper</em> node of   the next downstream station. Use the following data and do as   before:   <a href="../data/cs-a5-connection__to_node.txt">cs-a5-connection__to_node.txt</a></p></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>At this point, you might be wondering what&#39;s the purpose of the <code>connection__node__node</code> relationship class. Shouldn&#39;t it be enough to have <code>connection__from_node</code> and <code>connection__to_node</code> to represent the topology of the system? The answer is yes; but in addition to topology, we also need to represent the <em>delay</em> in the river branches. And for this purpose, we use a relationship parameter value on the <code>connection__node__node</code> relationships (see <code>Specifying relationship parameter values</code>).</p></div></div><ul><li><p>Create relationships of the class <code>node__commodity</code> to represent   that each node has to be in balance, for water nodes with respect to   water, for electricity nodes with respect to electricity. This way,   you link all nodes to either the commocity <code>water</code> or the commodity   <code>electricity</code>. Use the following data and do as before:   <a href="../data/cs-a5-node__commodity.txt">cs-a5-node__commodity.txt</a></p></li><li><p>Define that all nodes in our model have to be balanced at each time   step. To do this, you create a relationship of the class   <code>model__default_temporal_block</code> between the model <code>instance</code> and the   temporal<em>block `some</em>week` in the same way as before.</p></li><li><p>Define that our model is deterministic. To do this, you create a   relationship of the class <code>model__default_stochastic_structure</code>   between the model <code>instance</code> and the stochastic structure   <code>deterministic</code>, as well as a relationship of class   <code>stochastic_structure__stochastic_scenario</code> between the stochastid   structure <code>deterministic</code> and the stochastic scenario <code>realization</code>   in the same way as before.</p></li><li><p>In order to get the results from running Spine Opt written to the   ouput database, create relationships of the class <code>report__output</code>   between the report <code>my_report</code> and each of the following <code>output</code>   objects: <code>unit_flow</code>, <code>connection_flow</code>, and <code>node_state</code>. In   addition, you also need to create a relationship of the class   <code>model__report</code> between the model <code>instance</code> and the report   <code>my_report</code>.</p></li></ul><h4 id="Specifying-parameter-values-of-the-relationships"><a class="docs-heading-anchor" href="#Specifying-parameter-values-of-the-relationships">Specifying parameter values of the relationships</a><a id="Specifying-parameter-values-of-the-relationships-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-parameter-values-of-the-relationships" title="Permalink"></a></h4><ul><li><p>Finally, the values of all parameters have to be entered. Specify the capacity of all hydropower plants, and   their respective variable operating cost by entering <code>unit__from_node</code> parameter values as follows:</p><ul><li>Select the data from the text-box below and copy it to the clipboard (<strong>Ctrl+C</strong>): <a href="../data/cs-a5-unit__from_node-relationship-parameter-values.txt">cs-a5-unit__from_node-relationship-parameter-values.txt</a></li><li>In the <em>Spine DB Editor</em>, go to <em>Relationship tree</em> (on the bottom left of the window, usually), and click on <code>unit__from_node</code>. Then, go to <em>Relationship parameter value</em> (on the bottom-center of the window, usually). Make sure that the columns in the table are ordered as follows (drag and drop columns if you need to change their order): </li></ul><pre><code class="nohighlight hljs">  relationship_class_name | object_name_list | parameter_name | alternative_name | value | database</code></pre><ul><li>Select the first cell under <code>relationship_class_name</code> and press <strong>Ctrl+V</strong>. This will paste the parameter value data from the clipboard into the table.</li></ul></li><li><p>Specify the conversion ratio between discharged water and generated electricity for each hydropower station as well as a similar conversion rate (set to 1) to represent that water cannot be lost between upper and lower water nodes. Use the following data to enter the parameter values <code>unit__from_node</code>:   <a href="../data/cs-a5-unit__node__node-relationship-parameter-values.txt">cs-a5-unit__node__node-relationship-parameter-values.txt</a></p></li><li><p>Specify the average discharge and spillage in the first hours of the simulation. Use the following data to enter the parameter values <code>connection__from_node</code>:   <a href="../data/cs-a5-connection__from_node-relationship-parameter-values.txt">cs-a5-connection__from_node-relationship-parameter-values.txt</a></p></li><li><p>Finally, specify the delay (the time it takes for the water to run between water nodes) and the transfer ratio (being equal to 1) of different water connections. Use the following data to enter the parameter values <code>connection__node_node</code>:   <a href="../data/cs-a5-connection__node__node-relationship-parameter-values.txt">cs-a5-connection__node__node-relationship-parameter-values.txt</a></p></li><li><p>When you&#39;re ready, commit all changes to the database via the main   menu (<strong>Alt + F</strong>).</p></li></ul><h3 id="Using-the-Importer"><a class="docs-heading-anchor" href="#Using-the-Importer">Using the Importer</a><a id="Using-the-Importer-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-Importer" title="Permalink"></a></h3><h4 id="Additional-Steps-for-Project-Setup"><a class="docs-heading-anchor" href="#Additional-Steps-for-Project-Setup">Additional Steps for Project Setup</a><a id="Additional-Steps-for-Project-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Steps-for-Project-Setup" title="Permalink"></a></h4><ul><li>Drag the Data Connection icon <img src="../figs_a5/file-alt.png" alt="image"/> from the tool bar and drop it into the   Design View. This will open the <em>Add Data connection dialogue</em>. Type   in ‘Data Connection’ and click on <strong>Ok</strong>.</li><li>To import the model into the Spine database, you need to create an   <em>Import specification</em>. Create an <em>Import specification</em> by clicking   on the small arrow next to the Importer item (in the Main section of   the toolbar) and press <strong>New</strong>. The <em>Importer specification editor</em>   will pop-up.</li><li>Type ‘Import Model’ as the name of the specification. Save the   specification by using <strong>Ctrl+S</strong> and close the window.</li><li>Drag the newly created Import Model Importer item icon <img src="../figs_a5/database-import.png" alt="image"/>   from the tool bar and drop it into   the <em>Design View</em>. This will open the Add Importer dialogue. Type in   ‘Import Model’ and click on <strong>Ok</strong>.</li><li>Connect ‘Data Connection’ with ‘Import Model’ by first clicking on   one of the Data Connection’s connectors and then on one of the   Importer’s connectors. Connect similarly the importer with the input   database. Now the project should look similar to this:   <img src="../figs_a5/items_connections.png" alt="image"/></li><li>From the main menu, select <strong>File -&gt; Save project</strong>.</li></ul><h4 id="Importing-the-model"><a class="docs-heading-anchor" href="#Importing-the-model">Importing the model</a><a id="Importing-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Importing-the-model" title="Permalink"></a></h4><ul><li>Download <a href="../data/a5.xlsx">the data</a>   and <a href="../data/A5_importer_specification.json">the accompanying mapping</a>   (right click on the links, then select <em>Save link as...</em>).</li><li>Add a reference to the file containing the model.<ul><li>Select the <em>Data Connection item</em> in the <em>Design View</em> to show the <em>Data Connection properties</em> window (on the right side of the window usually).</li><li>In <em>Data Connection Properties</em>, click on , click on the icon furthest to the left <strong>Add file references</strong> and select the previously downloaded Excel file.</li><li>Next, double click on the <em>Import model</em> in the <em>Design view</em>. A window called <em>Select connector</em> for <em>Import Model</em> will pop-up, select Excel and klick <strong>OK</strong>. Next, still in the <em>Importer specification editor</em>, click on the main menu icon in the top right (or Press <strong>Alt + F</strong> to automatically display it) and import the mappings previously downloaded (by clicking on <strong>Import mappings</strong>). Finally, save by clicking <strong>Ctrl+S</strong> and exit the <em>Importer specification editor</em>.</li></ul></li></ul><h2 id="Executing-the-workflow"><a class="docs-heading-anchor" href="#Executing-the-workflow">Executing the workflow</a><a id="Executing-the-workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Executing-the-workflow" title="Permalink"></a></h2><p>Once the workflow is defined and input data is in place, the project is ready to be executed. Hit the <strong>Execute project</strong> button <img src="../figs_a5/play-circle.png" alt="image"/> on the tool bar.</p><p>You should see ‘Executing All Directed Acyclic Graphs’ printed in the <em>Event log</em> (on the lower left by default). SpineOpt output messages will appear in the <em>Process Log</em> panel in the middle. After some processing, ‘DAG 1/1 completed successfully’ appears and the execution is complete.</p><h2 id="Examining-the-results"><a class="docs-heading-anchor" href="#Examining-the-results">Examining the results</a><a id="Examining-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Examining-the-results" title="Permalink"></a></h2><p>Select the output data store and open the Spine DB editor.</p><p><img src="../figs_a5/case_study_a5_output.png" alt="image"/></p><p>To checkout the flow on the electricity load (i.e., the total electricity production in the system), go to <em>Object tree</em>, expand the <code>unit</code> object class, and select <code>electricity_load</code>, as illustrated in the picture above. Next, go to <em>Relationship parameter value</em> and double-click the first cell under <code>value</code>. The <em>Parameter value editor</em> will pop up. You should see something like this:</p><p><img src="../figs_a5/case_study_a5_output_electricity_load_unit_flow.png" alt="image"/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If you have used the importer to instantiate the model you can easily modify the parameters in the <strong>model</strong> worksheet, run the project and observe the differences in the results. If you need to make changes directly to the input database, in order for the importer not to overwrite them, you will need to dissassociate the importer from the input DB (right click in the connecting yellow arrow between the two items and click on <strong>remove</strong>).</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorialTwoHydro/">« Two hydro plants</a><a class="docs-footer-nextpage" href="../../how_to/change_the_solver/">Change the solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Friday 19 April 2024 08:07">Friday 19 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
